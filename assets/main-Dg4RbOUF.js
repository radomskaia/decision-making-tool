var Ut=Object.defineProperty;var Wt=(r,e,t)=>e in r?Ut(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var o=(r,e,t)=>Wt(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();const Ft="_container_12d55_1",vt="_flex_12d55_7",Gt="_flexColumn_12d55_11",kt="_alignCenter_12d55_15",Ht="_center_12d55_19",Xt="_justifyBetween_12d55_28",Yt="_gap30_12d55_37",Kt="_gap20_12d55_41",jt="_widthFull_12d55_58",$t="_positionRelative_12d55_80",c={container:Ft,flex:vt,flexColumn:Gt,alignCenter:kt,center:Ht,justifyBetween:Xt,gap30:Yt,gap20:Kt,widthFull:jt,positionRelative:$t},qt="_headerPrimary_fobv9_1",Qt="_header_fobv9_1",Ot={headerPrimary:qt,header:Qt};class N{constructor(e){o(this,"element");this.element=this.createView(e)}getElement(){return this.element}appendElement(...e){this.element.append(...e)}clearElement(){this.element.replaceChildren()}createDOMElement({tagName:e,classList:t,textContent:s,attributes:n}){const i=document.createElement(e);return t&&this.addClassList(t,i),n&&this.addAttributes(n,i),s&&this.addTextContent(s,i),i}addClassList(e,t){t=t??this.element,t.classList.add(...e)}addAttributes(e,t){t=t??this.element;for(const[s,n]of Object.entries(e))t.setAttribute(s,n)}addTextContent(e,t){t=t??this.element,t.textContent=e}}const Zt="_button_m7qff_1",Jt="_actionButton_m7qff_11",zt="_iconButton_m7qff_25",te="_settings_m7qff_34",it={button:Zt,actionButton:Jt,iconButton:zt,settings:te};class Rt extends N{constructor(e){super(),e&&this.addListener(e)}disabledElement(e){this.element.disabled=e}addListener(e){this.element.addEventListener("click",e)}createView(){return this.createDOMElement({tagName:"button",classList:[it.button]})}}const I={HOME:"Back to the start page",START:"Start",ADD_OPTION:"Add Option",CLEAR_LIST:"Clear List",PASTE_LIST:"Paste List",SAVE_LIST:"Save List to file",LOAD_LIST:"Load List from file",DELETE:"Delete",CONFIRM:"Confirm",CANCEL:"Cancel",CLOSE:"Close",BACK:"Back"},It={VOLUME:"Volume",ID:"ID",THEME:"Change theme"},O={NAMESPACE_SVG:"http://www.w3.org/2000/svg",NAMESPACE_XLINK:"http://www.w3.org/1999/xlink",QUALIFIED_NAME:"xlink:href"},f="./sprite.svg#",m={SOUND:{ON:f+"sound-on",OFF:f+"sound-off"},THEME:{ON:f+"theme-light",OFF:f+"theme-dark"},ALARM:f+"alarm",DELETE:f+"delete",SAVE:f+"save",LOAD:f+"load",BACK:f+"back",PASTE:f+"paste",CLEAR:f+"clear",PLAY:f+"play",ADD:f+"add"},ee={ariaLabel:"aria-label"},se={BUTTON:"button"};class Z extends Rt{constructor(t,s){super(s);o(this,"useSVGIcon");o(this,"svfElement");this.element.title=t.title,this.appendSVGIcon(t)}addClassSVG(t){var s;(s=this.svfElement)==null||s.classList.add(t)}appendSVGIcon(t){const{path:s,title:n}=t;if(s){const i=this.createSVGIcon({path:s,classList:[it.iconButton],attributes:{title:n,[ee.ariaLabel]:n}});this.appendElement(i)}}createSVGIcon({path:t,classList:s,attributes:n}){const i=document.createElementNS(O.NAMESPACE_SVG,"svg");s&&this.addClassList(s,i),this.addAttributes({...n,role:"img"},i);const a=document.createElementNS(O.NAMESPACE_SVG,"use");return a.setAttributeNS(O.NAMESPACE_XLINK,O.QUALIFIED_NAME,t),this.useSVGIcon=a,i.append(a),this.svfElement=i,i}}class Mt extends Z{constructor(e){super(e),this.addClassList([it.settings])}togglePath(e){var s;const t=e?this.pathOff:this.pathOn;(s=this.useSVGIcon)==null||s.setAttributeNS(O.NAMESPACE_XLINK,O.QUALIFIED_NAME,t)}addToggleListener(e){this.addListener(()=>{e.toggle()})}}class ne extends Mt{constructor(){const t=m.SOUND.ON,s=It.VOLUME;super({path:t,title:s});o(this,"pathOn");o(this,"pathOff",m.SOUND.OFF);o(this,"title");this.title=s,this.pathOn=t}}class xt{constructor(e){this.button=e,this.button=e}}const ie="Decision Making Tool",oe="radomskaia--decision-making-tool--",ot=.5,h=0,S=1,p=2,Y="",Tt=0,re=-1,ae=-1,ce=1,j={line:`
`,comma:",",dash:"-",hash:"#"},le={TYPE:"application/json",EXTENSION:".json",NAME:"option-list.json"},E={HOME:"/",DECISION_PICKER:"/decision-picker",NOT_FOUND:"404"},g={NOT_EVENT:"No event provided",ID_NOT_FOUND:"Can't update input value. Didn't find ID in the List",INVALID_FILE:"Invalid file",INVALID_LIST:"Invalid option list",CONTEXT_NOT_FOUND:"Failed to get context",ROUTE_NOT_FOUND:"Route not found",NOT_INITIALIZED:"Class is not initialized",PLAYBACK:"Can't play audio ",PAGE_NOT_FOUND:"Sorry, page not found",INIT_WHEEL_TEXT:"Please, press the button to start the wheel",VALIDATION:`Please add at least 2 valid options.

An option is considered valid if its title is not empty and its weight is greater than 0`},he=300,Q=class Q{constructor(){o(this,"prefix");this.prefix=oe}static getInstance(){return Q.instance}save(e,t){const s=this.prefix+e;globalThis.localStorage.setItem(s,JSON.stringify(t))}load(e,t){const s=this.prefix+e,n=globalThis.localStorage.getItem(s);if(!n)return null;try{const i=JSON.parse(n);return t(i)?i:null}catch{return null}}};o(Q,"instance",new Q);let b=Q;var pt=(r=>(r.Title="title",r.Weight="weight",r))(pt||{}),v=(r=>(r.optionListValue="optionListValue",r.soundSettings="soundSettings",r))(v||{}),F=(r=>(r.strike="strike",r.end="end",r))(F||{});const ue=2,gt=j.hash,de={ID:"id",TITLE:"title",WEIGHT:"weight"},pe={LAST_ID:"lastId",LIST:"list"},d=class d{constructor(e=de,t=pe,s=gt){this.itemKeys=e,this.listKeys=t,this.idPrefix=s}static getInstance(){return d.instance||(d.instance=new d),d.instance}static isBoolean(e){return typeof e=="boolean"}static isPositiveNumber(e){return d.isNumber(e)&&e>=h}static isValidWeight(e){const t=typeof e=="string"?Number(e):e;return!Number.isNaN(t)&&this.isPositiveNumber(t)}static isValidOption(e){return e.title.trim().length>h&&Number(e.weight)>h}static hasMinimumOptions(e){return e.length>=ue}static isOptionsCountValid(e){const t=e.list.filter(s=>d.isValidOption(s));return d.hasMinimumOptions(t)}static isObject(e){return typeof e=="object"&&e!==null}static isString(e){return typeof e=="string"}static isNumber(e){return typeof e=="number"}static isEmptyOrStringifiedNumber(e){return e=e===Y?e:Number(e),!(d.isNumber(e)&&Number.isNaN(e))}isOptionListValue(e){if(!(this.isList(e)&&d.isPositiveNumber(e.lastId)&&Array.isArray(e.list)))return!1;for(const t of e.list)if(!this.isOptionItemValue(t,e.lastId))return!1;return!0}isList(e){return d.isObject(e)?this.listKeys.LAST_ID in e&&this.listKeys.LIST in e:!1}isOption(e){return d.isObject(e)?this.itemKeys.ID in e&&this.itemKeys.TITLE in e&&this.itemKeys.WEIGHT in e:!1}isOptionId(e,t){if(!d.isString(e)||e.slice(Tt,this.idPrefix.length)!==gt)return!1;let s=Number(e.slice(this.idPrefix.length));return!(Number.isNaN(s)||s<h||s>t)}isOptionItemValue(e,t){return this.isOption(e)&&this.isOptionId(e.id,t)&&d.isEmptyOrStringifiedNumber(e.weight)&&d.isString(e.title)}};o(d,"instance");let T=d;const ge=.7,me=""+new URL("flint-strike-CTtTXcws.mp3",import.meta.url).href,Ee=""+new URL("end-sound-BuX6zaOv.mp3",import.meta.url).href,x=class x extends xt{constructor(t){super(t);o(this,"isOff",!1);o(this,"audioElements",{[F.strike]:new Audio(me),[F.end]:new Audio(Ee)});this.init(),this.audioElements[F.end].volume=ge,window.addEventListener("beforeunload",()=>{b.getInstance().save(v.soundSettings,this.isOff)})}static getInstance(t){if(!x.instance){if(!t)throw new Error(g.NOT_INITIALIZED);x.instance=new x(t)}return x.instance}updateSettings(){for(const t of Object.values(this.audioElements))t.muted=this.isOff;this.button.togglePath(this.isOff)}onEnded(t,s){this.audioElements[t].addEventListener("ended",s,{once:!0})}playAudio(t){this.isOff||this.audioElements[t].play().catch(s=>console.error(g.PLAYBACK+t,s))}stopAudio(t){this.isOff||this.audioElements[t].currentTime===h||(this.audioElements[t].pause(),this.audioElements[t].currentTime=h)}getButton(){return this.button}toggle(){this.isOff=!this.isOff,this.updateSettings()}init(){const t=b.getInstance().load(v.soundSettings,T.isBoolean);t!==null&&(this.isOff=t,this.updateSettings());for(const s of Object.values(this.audioElements))s.load()}};o(x,"instance");let J=x;class fe extends Mt{constructor(){const t=m.THEME.ON,s=It.THEME;super({path:t,title:s});o(this,"pathOn");o(this,"pathOff",m.THEME.OFF);o(this,"title");this.title=s,this.pathOn=t}}const w=512,St=25,lt=w/p,ht=1e3,Ie=100,H={RGB_MAX:255,OPACITY:.8,TYPE:"rgb"},q={DURATION:5,TURNS_COUNT:5},l={CENTER:{X:lt,Y:lt+St/p},RADIUS:{BIG:lt-St,SMALL:20},INITIAL_DEGREE:-90,HALF_DEGREE:180,START_ANGLE:0,FULL_RADIAN:Math.PI*p},L={OFFSET:.55,FONT:{SIZE:"16px",FAMILY:"inter"},ALIGN:"center",BASELINE:"middle",MAX_WIDTH:100,MIN_ANGLE:.18,ELLIPSIS:"..."},A={ANGLE:{MIN:20,MAX:60},Y:{TOP:50,BOTTOM:10,MIDDLE:20},WIDTH:35};function Te(r,e){const t=(r+e)/p,s=l.RADIUS.BIG*L.OFFSET,n=l.CENTER.X+Math.cos(t)*s,i=l.CENTER.Y+Math.sin(t)*s,a=t+Math.PI/ot;return{textX:n,textY:i,textAngle:a}}function Le(r,e){return l.FULL_RADIAN/r*e}function ut(r){return r*(Math.PI/l.HALF_DEGREE)}function Ae(r){return Math.floor((Math.random()*H.RGB_MAX+r)/p)}function Ne(r){const e=r*p;return e>H.RGB_MAX?(e-H.RGB_MAX)/p:(e+H.RGB_MAX)/p}function Oe(r){const e=[],t=H.TYPE;for(let s=h;s<t.length;s++)e.push(Ae(r));return e}function Ct(r){return`rgb(${r.join(j.comma)},${H.OPACITY})`}function Se(r){let e=h;for(const t of r){const s=Number(t.weight);e+=s}return e}function Ce(r){return r<ot?p*r*r:S-Math.pow(-2*r+p,p)/p}function we(r,e){return S-r/e}function De(r,e=he){let t;return function(){clearTimeout(t),t=setTimeout(()=>r(),e)}}function _e(){return document.body.scrollHeight-window.innerHeight>=window.scrollY}function dt(r){return(r+l.FULL_RADIAN)%l.FULL_RADIAN}class be extends N{constructor(t=window.devicePixelRatio){super(t);o(this,"context");o(this,"drawSectors",(t,s,n)=>{this.context.clearRect(h,h,w,w);for(const i of t){let{startAngle:a,angle:u,color:M,title:G,isTitle:yt}=i;if(n){const{offset:at,updateSector:ct}=n;i.startAngle+=at,i.startAngle>l.FULL_RADIAN&&(i.startAngle-=l.FULL_RADIAN),ct(a,u,G,M)}const Nt=a+u;if(this.drawSector(a,Nt,M,s.stroke),yt){const{textX:at,textY:ct,textAngle:Vt}=Te(a,Nt);this.drawText(this.truncateText(G),at,ct,Vt,s)}}this.drawCircle(s.stroke,l.RADIUS.SMALL+S),this.drawCircle(s.stroke,l.RADIUS.BIG),this.drawCursor(s,n==null?void 0:n.angle)});o(this,"drawSector",(t,s,n,i)=>{const{context:a}=this;a.beginPath(),a.moveTo(l.CENTER.X,l.CENTER.Y),a.arc(l.CENTER.X,l.CENTER.Y,l.RADIUS.BIG,t,s),a.closePath(),a.fillStyle=n,a.strokeStyle=i,a.fill(),a.stroke()});o(this,"drawText",(t,s,n,i,a)=>{const{context:u}=this;u.save(),u.translate(s,n),u.rotate(i),u.font=`${L.FONT.SIZE} ${L.FONT.FAMILY}`,u.textAlign=L.ALIGN,u.textBaseline=L.BASELINE,u.fillStyle=a.stroke,u.strokeStyle=a.cursor,u.strokeText(t,h,h),u.fillText(t,h,h),u.restore()});this.context=this.getContext(),this.context.scale(t,t),this.drawClip()}getContext(){const t=this.element.getContext("2d");if(!t)throw new Error(g.CONTEXT_NOT_FOUND);return t}drawCursor(t,s){const{context:n}=this;n.save(),s&&this.rotateCursor(s),n.beginPath(),n.moveTo(l.CENTER.X,A.Y.TOP),n.lineTo(l.CENTER.X-A.WIDTH/p,A.Y.BOTTOM),n.lineTo(l.CENTER.X,A.Y.MIDDLE),n.lineTo(l.CENTER.X+A.WIDTH/p,A.Y.BOTTOM),n.closePath(),n.fillStyle=t.cursor,n.strokeStyle=t.stroke,n.fill(),n.stroke(),n.restore()}createView(t){const s=w*t,n=this.createDOMElement({tagName:"canvas",attributes:{width:s.toString(),height:s.toString()}});return s>w&&(n.style.width=w.toString()+"px"),n}drawCircle(t,s){const{context:n}=this;n.lineWidth++,n.beginPath(),n.arc(l.CENTER.X,l.CENTER.Y,s,l.START_ANGLE,l.FULL_RADIAN,!0),n.closePath(),n.strokeStyle=t,s===l.RADIUS.SMALL+S&&(n.fillStyle=t,n.fill()),n.stroke(),n.lineWidth--}drawClip(){const{context:t}=this;t.beginPath(),t.rect(h,h,w,w),t.arc(l.CENTER.X,l.CENTER.Y,l.RADIUS.SMALL,l.START_ANGLE,l.FULL_RADIAN,!0),t.clip()}rotateCursor(t){const{context:s}=this;s.translate(l.CENTER.X,A.Y.MIDDLE),s.rotate(t),s.translate(-256,-20)}truncateText(t){const{context:s}=this;let n=s.measureText(t).width;if(!(n>L.MAX_WIDTH))return t;let i=t,a=i+L.ELLIPSIS;for(;n>L.MAX_WIDTH;)i=i.slice(Tt,ae),a=i+L.ELLIPSIS,n=s.measureText(a).width;return i+=L.ELLIPSIS,i}}const Re=15,Me=80,Lt={TITLE:"Title",WEIGHT:"Weight",INSTRUCTION:`
Paste a list of new options in a CSV-like format:

title,weight(number)              -> | title                           |weight|
title,1                           -> | title                           | 1 |
title with whitespace,2           -> | title with whitespace           | 2 |
title , with , commas,3           -> | title , with , commas           | 3 |
title with &quot;quotes&quot;,4   -> | title with &quot;quotes&quot;   | 4 |
`},rt={TEXT:"text",NUMBER:"number",FILE:"file"},Pt="duration",xe="any",P=class P{constructor(){o(this,"validator");o(this,"separator");o(this,"config");this.validator=T.getInstance(),this.separator=j,this.config=le}static getInstance(){return P.instance||(P.instance=new P),P.instance}loadJSON(e){const t=document.createElement("input");t.type=rt.FILE,t.accept=this.config.EXTENSION,t.addEventListener("change",()=>{const s=t.files;if(!s)throw new Error(g.INVALID_FILE);s[Tt].text().then(n=>{const i=JSON.parse(n);if(!this.validator.isOptionListValue(i))throw new Error(g.INVALID_LIST);e.setList(i)})}),t.click()}saveJSON(e){let t=new Blob([JSON.stringify(e.getList())],{type:this.config.TYPE}),s=URL.createObjectURL(t);const n=document.createElement("a");n.href=s,n.download=this.config.NAME,n.click(),URL.revokeObjectURL(s)}parseCSV(e){var n;const t=e.split(this.separator.line),s={list:[]};for(const i of t){const a=i.split(this.separator.comma),u=(n=a.pop())==null?void 0:n.trim();if(!u||!T.isValidWeight(u))continue;const M=a.join(this.separator.comma).trim();if(!M)continue;const G={title:M,weight:u};s.list.push(G)}return T.isPositiveNumber(s.list.length)?s:null}loadLSData(){const e=b.getInstance().load(v.optionListValue,this.validator.isOptionListValue.bind(T.getInstance()));if(!e)return null;const t=e.list.filter(s=>T.isValidOption(s));return T.hasMinimumOptions(t)?[...t].sort(()=>Math.random()-ot):null}};o(P,"instance");let K=P;class Pe{constructor(e,t,s){o(this,"sectorData",[]);o(this,"duration",q.DURATION*ht);o(this,"startAngle",ut(l.INITIAL_DEGREE));o(this,"currentTitle",null);o(this,"currentTitleColor",Y);o(this,"startAnimation",null);o(this,"turnsCount",q.TURNS_COUNT);o(this,"audio",J.getInstance());o(this,"cursorAnimationDuration",ht);o(this,"cursorAnimationStartTimestamp",h);o(this,"cursorBounceAngle",ut(A.ANGLE.MIN));o(this,"isRotate",!1);o(this,"cursorAngle",h);o(this,"colors");o(this,"updateCurrentSector",(e,t,s,n)=>{this.isAngleInCursorRange(e,t)&&(s!==this.currentTitle||n!==this.currentTitleColor)&&(this.isRotate&&(this.cursorAngle-=Math.floor(this.cursorAngle/l.FULL_RADIAN)*l.FULL_RADIAN),this.isRotate=!0,this.cursorAnimationStartTimestamp=Date.now(),this.audio.stopAudio(F.strike),this.audio.playAudio(F.strike),this.currentTitle=s,this.currentTitleColor=n,this.titleSection.textContent=s)});this.drawSectors=e,this.titleSection=t,this.toggleViewState=s;const n=nt.getInstance();n.addListener(this.changeWheelColors.bind(this)),this.colors=n.getColors(),this.drawSectors=e,this.titleSection=t,this.init(),this.drawSectors(this.sectorData,{cursor:this.colors.cursor,stroke:this.colors.stroke}),this.toggleViewState=s}setDuration(e){this.duration=e*ht}isSectorData(){return this.sectorData.length>h}animateWheel(){if(R.getInstance().getCurrentRoute()!==E.DECISION_PICKER){this.toggleViewState(!0,this.currentTitleColor);return}const e=Date.now();this.startAnimation||(this.startAnimation=e);const t=e-this.startAnimation;if(t>this.duration&&!this.isRotate){this.endWheelAnimation();return}const s=this.getOffsetAngle(t);let n=this.cursorAngle;this.isRotate&&(n=this.animateCursor()),this.drawSectors(this.sectorData,{cursor:this.colors.cursor,stroke:this.colors.stroke},{offset:s,updateSector:this.updateCurrentSector.bind(this),angle:n}),requestAnimationFrame(()=>this.animateWheel())}changeWheelColors(e){this.colors=e;for(const t of this.sectorData){const s=[];for(const i of t.rgbArray)s.push(Ne(i));t.rgbArray=s;const n=Ct(s);!this.startAnimation&&this.currentTitleColor===t.color&&(this.currentTitleColor=n,this.toggleViewState(!0,n)),t.color=n}this.drawSectors(this.sectorData,{cursor:this.colors.cursor,stroke:this.colors.stroke})}animateCursor(){const e=Date.now(),t=this.cursorAngle;let n=(e-this.cursorAnimationStartTimestamp)/this.cursorAnimationDuration,i;return this.cursorBounceAngle=this.calculateCursorAngle(e),n<=ot?(n*=p,i=Math.sin(n*Math.PI)*-this.cursorBounceAngle):(n*=p,i=S-Math.sin(n*Math.PI)*this.cursorBounceAngle),this.cursorAngle=t-i,n>=S?(this.isRotate=!1,this.cursorAngle=h,h):i}calculateCursorAngle(e){const t=e-this.cursorAnimationStartTimestamp,s=this.cursorAnimationDuration/p,n=Math.max(h,(s-t)/s);return ut(A.ANGLE.MIN+n*(A.ANGLE.MAX-A.ANGLE.MIN))}isAngleInCursorRange(e,t){const s=dt(this.startAngle),n=dt(e+t);return e=dt(e),e<n?s>=e&&s<=n:s>=e||s<=n}getOffsetAngle(e){const t=we(e,this.duration);return(this.turnsCount*l.FULL_RADIAN+Math.floor(Math.random()*l.FULL_RADIAN))/Ie*Ce(t)}endWheelAnimation(){this.audio.playAudio(F.end),this.startAnimation=null,this.turnsCount=q.TURNS_COUNT,this.toggleViewState(!0,this.currentTitleColor),this.audio.getButton().disabledElement(!1)}init(){const e=K.getInstance().loadLSData();if(!e)return;const t=Se(e);let s=this.startAngle;for(const{weight:n,title:i}of e){const a=Le(t,Number(n)),u=Oe(this.colors.thinner),M=Ct(u),G={startAngle:s,angle:a,color:M,rgbArray:u,title:i,isTitle:a>L.MIN_ANGLE};s+=a,this.sectorData.push(G)}}}class At extends N{constructor(e){super(),e&&(this.element.value=e)}get value(){return this.element.value}addListener(e){this.element.addEventListener("change",e)}createView(){return this.createDOMElement({tagName:"input"})}}const Be="_label_c25p0_11",ye="_icon_c25p0_17",Ve="_input_c25p0_28",Ue="_form_c25p0_44",We="_highlight_c25p0_54",$={label:Be,icon:ye,input:Ve,form:Ue,highlight:We};class Fe extends At{constructor(t){super(t);o(this,"duration",q.DURATION);o(this,"id",Pt);this.element.type=rt.NUMBER,this.element.min=this.duration.toString(),this.element.autofocus=!0,this.element.addEventListener("beforeinput",s=>{s.data===j.dash&&s.preventDefault()}),this.element.id=this.id}disabledElement(t){this.element.disabled=t}addLabel(t,s){const n=this.createDOMElement({tagName:"label",classList:s,attributes:{for:this.id,title:t}});return n.append(this.createSVGIcon(m.ALARM)),n}createSVGIcon(t){const s=document.createElementNS(O.NAMESPACE_SVG,"svg");this.addAttributes({role:"img"},s),s.classList.add($.icon);const n=document.createElementNS(O.NAMESPACE_SVG,"use");return n.setAttributeNS(O.NAMESPACE_XLINK,O.QUALIFIED_NAME,t),s.append(n),s}}const B=class B extends N{constructor(){super();o(this,"canvas");o(this,"wheel");o(this,"text");o(this,"controllerElements",[]);o(this,"form",null);o(this,"controlsWrapper");o(this,"input",null);o(this,"toggleViewState",(t,s)=>{for(const n of this.controllerElements)n.disabledElement(!t);this.text.classList.toggle($.highlight,t),this.text.style.backgroundColor=s});this.canvas=new be,this.text=this.createDOMElement({tagName:"p",textContent:g.INIT_WHEEL_TEXT}),this.controlsWrapper=this.createControllsWrapper(),this.appendElement(this.controlsWrapper,this.text,this.canvas.getElement())}static getInstance(){return B.instance||(B.instance=new B),B.instance}isRenderWheel(){this.wheel=new Pe(this.canvas.drawSectors,this.text,this.toggleViewState);const t=this.wheel.isSectorData();return t&&(this.text.textContent=g.INIT_WHEEL_TEXT,this.text.style.backgroundColor=Y),t}focusInput(){var t;(t=this.input)==null||t.focus()}createView(){return this.createDOMElement({tagName:"main",classList:[c.container,c.flex,c.gap30,c.flexColumn,c.alignCenter]})}addButtons(){const t=new Z({title:I.BACK,path:m.BACK},()=>R.getInstance().navigateTo(E.HOME)),s=new Z({title:I.START,path:m.PLAY},()=>{var n;this.wheel&&((n=this.form)!=null&&n.reportValidity())&&(J.getInstance().getButton().disabledElement(!0),this.toggleViewState(!1,Y),this.wheel.animateWheel())});this.controllerElements.push(t,s),this.controlsWrapper.append(t.getElement(),s.getElement())}createControllsWrapper(){return this.controlsWrapper=this.createDOMElement({tagName:"div",classList:[c.flex,c.center,c.gap30]}),this.addButtons(),this.form=this.addInputForm(),this.controlsWrapper}addInputForm(){const t=this.createDOMElement({tagName:"form",classList:[c.positionRelative,$.form]}),s=new Fe(q.DURATION.toString());this.controllerElements.push(s),s.addListener(()=>{var i;return(i=this.wheel)==null?void 0:i.setDuration(Number(s.value))});const n=s.getElement();return n.classList.add($.input),t.append(s.addLabel(Pt,[$.label]),n),this.controlsWrapper.append(t),this.input=n,t}};o(B,"instance");let z=B;const ve="_optionsList_lgk06_1",Ge="_optionItem_lgk06_11",ke="_title_lgk06_26",He="_weight_lgk06_27",Xe="_icon_lgk06_52",k={optionsList:ve,optionItem:Ge,title:ke,weight:He,icon:Xe},C=class C extends N{constructor(t){super();o(this,"_id");t||C.incrementId(),this._id=t||`${gt}${C.getId()}`,this.element.textContent=this._id}get id(){return this._id}static resetId(){C.id=h}static getId(){return C.id}static setId(t){C.id=t}static incrementId(){C.id++}createView(){return this.createDOMElement({tagName:"div",attributes:{title:It.ID}})}};o(C,"id",h);let X=C;class Ye extends At{constructor(e){super(e),this.element.placeholder=Lt.TITLE,this.element.type=rt.TEXT}}class Ke extends At{constructor(e){super(e),this.element.placeholder=Lt.WEIGHT,this.element.type=rt.NUMBER,this.element.step=xe,this.element.min=h.toString(),this.element.addEventListener("beforeinput",t=>{t.data===j.dash&&t.preventDefault()})}}class je extends N{constructor(t){super();o(this,"id");o(this,"title");o(this,"weight");o(this,"button");this.id=this.addID(t==null?void 0:t.id),this.title=this.addTitleInput(t==null?void 0:t.title),this.weight=this.addWeightInput(t==null?void 0:t.weight),this.button=this.addDeleteButton()}getValue(){return{id:this.id,title:this.title.value,weight:this.weight.value}}focusInput(){this.title.getElement().focus()}addListener(t,s){this[t].addListener(s)}createView(){return this.createDOMElement({tagName:"li",classList:[k.optionItem]})}addID(t){const s=new X(t);return this.appendElement(s.getElement()),s.id}addTitleInput(t){const s=new Ye(t),n=s.getElement();return n.classList.add(k.title),this.appendElement(n),s}addWeightInput(t){const s=new Ke(t),n=s.getElement();return n.classList.add(k.weight),this.appendElement(n),s}addDeleteButton(){const t=new Z({title:I.DELETE,path:m.DELETE});return t.getElement().classList.add(k.button),t.addClassSVG(k.icon),this.appendElement(t.getElement()),t}}class $e extends N{constructor(t){super();o(this,"optionListValue",{lastId:h,list:[]});o(this,"inputTypes",[pt.Title,pt.Weight]);t&&(this.optionListValue=t),window.addEventListener("beforeunload",()=>{document.activeElement instanceof HTMLInputElement&&document.activeElement.blur(),b.getInstance().save(v.optionListValue,this.optionListValue)})}init(){const t=b.getInstance().load(v.optionListValue,T.getInstance().isOptionListValue.bind(T.getInstance()));t===null?this.addOption():this.setList(t)}addOption(t){const s=new je(t);this.appendElement(s.getElement()),s.focusInput();const n=s.getValue().id;if(!n)throw new Error(g.ID_NOT_FOUND);s.addListener("button",()=>{this.deleteOption(n,s)});for(const i of this.inputTypes)s.addListener(i,a=>{if(!a)throw new Error(g.NOT_EVENT);this.inputHandler(i,n,a)});t!=null&&t.id||this.updateList(s.getValue(),X.getId())}getList(){return structuredClone(this.optionListValue)}setList(t){t.lastId&&(this.reset(),this.optionListValue=t,X.setId(t.lastId));for(const s of t.list)this.addOption(s)}reset(){this.optionListValue.lastId=h,this.optionListValue.list=[],X.resetId(),this.clearElement()}createView(){return this.createDOMElement({tagName:"ul",classList:[k.optionsList]})}updateList(t,s){this.optionListValue.list.push(t),this.optionListValue.lastId=s}deleteOption(t,s){const n=this.getOptionIndex(t);this.optionListValue.list.splice(n,ce),s.getElement().remove(),this.optionListValue.list.length===h&&this.reset()}getOptionIndex(t){const s=this.optionListValue.list.findIndex(n=>n.id===t);if(s===re)throw new Error(g.ID_NOT_FOUND);return s}inputHandler(t,s,n){const i=this.optionListValue.list,a=this.getOptionIndex(s);n.target instanceof HTMLInputElement&&(i[a][t]=n.target.value)}}const qe="_modal_4dba0_1",Qe="_wrapper_4dba0_17",Ze="_validText_4dba0_30",Je="_form_4dba0_34",ze="_input_4dba0_39",tt={modal:qe,wrapper:Qe,validText:Ze,form:Je,input:ze};class Bt extends N{constructor(){super();o(this,"modalWrapper");this.modalWrapper=this.addWrapper(),this.modalWrapper.append(this.addContent()),this.element.addEventListener("close",()=>{this.element.remove()})}showModal(){document.body.append(this.element),this.element.showModal()}createView(){const t=this.createDOMElement({tagName:"dialog",classList:[tt.modal]});return t.addEventListener("click",s=>{s.target===s.currentTarget&&this.element.close()}),t}addWrapper(){const t=this.createDOMElement({tagName:"div",classList:[tt.wrapper,c.flex,c.flexColumn,c.alignCenter,c.gap20]});return this.element.append(t),t}}class st extends Rt{constructor(e,t){super(t),this.element.textContent=e,this.addClassList([it.actionButton])}}const D=class D extends Bt{constructor(e){super(),this.optionList=e,this.optionList=e}static getInstance(e){if(!D.instance&&e&&(D.instance=new D(e)),!D.instance)throw new Error(g.NOT_INITIALIZED);return D.instance}addContent(){const e=this.createDOMElement({tagName:"form",classList:[tt.form,c.gap20]}),t=this.createTextareaElement(),s=this.createCancelButton();this.addCloseListener(()=>{t.value=Y});const n=new st(I.CONFIRM).getElement();return e.addEventListener("submit",i=>{this.submitHandler(i,t)}),e.append(t,s,n),e}createTextareaElement(){const e=this.createDOMElement({tagName:"textarea",classList:[tt.input]});return e.placeholder=Lt.INSTRUCTION,e.rows=Re,e.cols=Me,e}createCancelButton(){const e=new st(I.CANCEL);return e.getElement().type=se.BUTTON,e.addListener(()=>{this.element.close()}),e.getElement()}addCloseListener(e){this.element.addEventListener("close",e)}submitHandler(e,t){e.preventDefault();const s=t.value.trim(),n=K.getInstance().parseCSV(s);n&&(this.element.close(),this.optionList.setList(n))}};o(D,"instance");let mt=D;const y=class y extends Bt{constructor(){super(),this.addContent()}static getInstance(){return y.instance||(y.instance=new y),y.instance}addContent(){const e=this.createDOMElement({tagName:"div",classList:[c.flex,c.flexColumn,c.alignCenter,c.gap20]}),t=this.createDOMElement({tagName:"p",classList:[tt.validText],textContent:g.VALIDATION}),s=new st(I.CLOSE,()=>{this.element.close()}).getElement();return e.append(t,s),e}};o(y,"instance");let Et=y;const ts="_buttonWrapper_gr9ed_1",es="_highlight_gr9ed_14",wt={buttonWrapper:ts,highlight:es},V=class V extends N{constructor(){super();o(this,"buttonsConfig",[{title:I.ADD_OPTION,path:m.ADD,callback:()=>{this.optionList.addOption(),window.scrollTo(h,document.body.scrollHeight)}},{title:I.CLEAR_LIST,path:m.CLEAR,callback:()=>this.optionList.reset()},{title:I.PASTE_LIST,path:m.PASTE,callback:()=>mt.getInstance(this.optionList).showModal()},{title:I.SAVE_LIST,path:m.SAVE,callback:()=>K.getInstance().saveJSON(this.optionList)},{title:I.LOAD_LIST,path:m.LOAD,callback:()=>K.getInstance().loadJSON(this.optionList)},{title:I.START,path:m.PLAY,callback:()=>{const t=this.optionList.getList();T.isOptionsCountValid(t)?R.getInstance().navigateTo(E.DECISION_PICKER):Et.getInstance().showModal()}}]);o(this,"optionList");o(this,"buttonWrapper");this.optionList=new $e,this.optionList.init(),this.appendElement(this.optionList.getElement()),this.buttonWrapper=this.createButtonWrapper(),this.addScrollListener()}static getInstance(){return V.instance||(V.instance=new V),V.instance}saveToLocalStorage(){b.getInstance().save(v.optionListValue,this.optionList.getList())}createView(){return this.createDOMElement({tagName:"main",classList:[c.container,c.flex,c.gap30,c.flexColumn,c.alignCenter]})}addButtons(t){for(const{title:s,path:n,callback:i}of this.buttonsConfig){const a=new Z({title:s,path:`${n}`},i);t.append(a.getElement())}}createButtonWrapper(){const t=this.createDOMElement({tagName:"div",classList:[wt.buttonWrapper,c.flex,c.alignCenter,c.justifyBetween]});return this.addButtons(t),this.appendElement(t),t}addScrollListener(){window.addEventListener("scroll",De(()=>{this.buttonWrapper.classList.toggle(wt.highlight,_e())}))}};o(V,"instance");let et=V;const _=class _{constructor(){o(this,"routes",[]);o(this,"currentPath",Y);globalThis.addEventListener("hashchange",()=>{this.routerChange()})}static getInstance(){return _.instance||(_.instance=new _),_.instance}static canNavigateToDecision(e){if(e.path!==E.DECISION_PICKER)return!0;const t=e.component.getInstance();return t instanceof z&&t.isRenderWheel()}addRoutes(e){this.routes=e,this.routerChange()}navigateTo(e){this.currentPath=e,this.clearPage();let t=this.findValidRoute(e);if(!t)throw new Error(g.ROUTE_NOT_FOUND);globalThis.location.hash=t.path,document.body.append(t.component.getInstance().getElement());const s=t.component.getInstance();s instanceof z?s.focusInput():s instanceof et&&window.scrollTo(S,S)}getCurrentRoute(){return this.currentPath}findValidRoute(e){var s,n;let t=this.routes.find(i=>i.path===e)||this.routes.find(i=>i.path===E.NOT_FOUND);if(e===E.DECISION_PICKER){const i=(s=this.routes.find(a=>a.path===E.HOME))==null?void 0:s.component.getInstance();i instanceof et&&i.saveToLocalStorage()}return t&&!_.canNavigateToDecision(t)&&(t=(n=this.routes)==null?void 0:n.find(i=>i.path===E.HOME)),t}clearPage(){if(!this.routes)throw new Error(g.ROUTE_NOT_FOUND);for(const e of this.routes){const t=e.component.getInstance().getElement();t.parentNode&&t.remove()}}routerChange(){const e=globalThis.location.hash.slice(j.hash.length)||E.HOME;e!==this.currentPath&&this.navigateTo(e)}};o(_,"instance");let R=_;const ss=0,ns=255,Dt="#ccc19f",_t="#1c274d",is="(prefers-color-scheme: dark)",os="data-theme",bt={DARK_THEME:{thinner:ss,cursor:_t,stroke:Dt},LIGHT_THEME:{thinner:ns,cursor:Dt,stroke:_t}},U=class U extends xt{constructor(t){super(t);o(this,"isOff");o(this,"colors",null);o(this,"mediaQueryList");o(this,"toggleListener",null);this.mediaQueryList=globalThis.matchMedia(is),this.isOff=this.mediaQueryList.matches,this.setColors(this.isOff),this.changeTheme(this.isOff),this.mediaQueryList.addEventListener("change",s=>{this.changeTheme(s.matches)})}static getInstance(t){if(!U.instance){if(!t)throw new Error(g.NOT_INITIALIZED);U.instance=new U(t)}return U.instance}getColors(){if(this.colors)return this.colors;throw new Error(g.NOT_INITIALIZED)}toggle(){this.isOff=!this.isOff,this.changeTheme(this.isOff)}addListener(t){this.toggleListener=t}setColors(t){this.colors=t?bt.DARK_THEME:bt.LIGHT_THEME}changeTheme(t){this.button.togglePath(t),this.setColors(t),document.body.toggleAttribute(os,t),R.getInstance().getCurrentRoute()===E.DECISION_PICKER&&this.toggleListener&&this.colors&&this.toggleListener(this.colors)}};o(U,"instance");let nt=U;class rs extends N{constructor(){super();o(this,"settingsButton",{sound:{button:ne,action:J},theme:{button:fe,action:nt}});o(this,"buttonWrapper");this.buttonWrapper=this.createButtonWrapper(),this.appendElement(this.buttonWrapper)}addSoundButton(t){const s=new this.settingsButton[t].button,n=this.settingsButton[t].action.getInstance(s);return s.addToggleListener(n),this.buttonWrapper.append(s.getElement()),this}createView(){const t=this.createDOMElement({tagName:"header",classList:[Ot.header,c.container,c.flex,c.alignCenter,c.justifyBetween,c.widthFull]}),s=this.createDOMElement({tagName:"h1",textContent:ie,classList:[Ot.headerPrimary]});return t.append(s),t}createButtonWrapper(){return this.createDOMElement({tagName:"div",classList:[c.flex,c.center,c.gap30]})}}const W=class W extends N{constructor(){super();o(this,"homeButton");this.homeButton=new st(I.HOME,()=>R.getInstance().navigateTo(E.HOME)),this.appendElement(this.homeButton.getElement())}static getInstance(){return W.instance||(W.instance=new W),W.instance}createView(){const t=this.createDOMElement({tagName:"main",classList:[c.flex,c.container,c.flexColumn,c.center,c.gap30]}),s=this.createDOMElement({tagName:"p",textContent:g.PAGE_NOT_FOUND});return t.append(s),t}};o(W,"instance");let ft=W;const as=[{path:E.HOME,component:et},{path:E.DECISION_PICKER,component:z},{path:E.NOT_FOUND,component:ft}],cs=document.body,ls=new rs().addSoundButton("theme").addSoundButton("sound").getElement();cs.append(ls);R.getInstance().addRoutes(as);window.scrollTo(S,S);
//# sourceMappingURL=main-Dg4RbOUF.js.map
