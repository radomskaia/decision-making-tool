var Wt=Object.defineProperty;var Ft=(r,e,t)=>e in r?Wt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var o=(r,e,t)=>Ft(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();const vt="_container_1pwd0_1",Gt="_flex_1pwd0_11",Ht="_flexColumn_1pwd0_15",Xt="_alignCenter_1pwd0_19",kt="_center_1pwd0_23",Yt="_justifyBetween_1pwd0_32",Kt="_flexWrap_1pwd0_36",jt="_gap30_1pwd0_40",$t="_gap20_1pwd0_44",qt="_gap10_1pwd0_48",Qt="_widthFull_1pwd0_61",zt="_positionRelative_1pwd0_83",a={container:vt,flex:Gt,flexColumn:Ht,alignCenter:Xt,center:kt,justifyBetween:Yt,flexWrap:Kt,gap30:jt,gap20:$t,gap10:qt,widthFull:Qt,positionRelative:zt},Zt="_headerPrimary_fobv9_1",Jt="_header_fobv9_1",St={headerPrimary:Zt,header:Jt};class N{constructor(e){o(this,"element");this.element=this.createView(e)}getElement(){return this.element}appendElement(...e){this.element.append(...e)}clearElement(){this.element.replaceChildren()}createDOMElement({tagName:e,classList:t,textContent:s,attributes:n}){const i=document.createElement(e);return t&&this.addClassList(t,i),n&&this.addAttributes(n,i),s&&this.addTextContent(s,i),i}addClassList(e,t){t=t??this.element,t.classList.add(...e)}addAttributes(e,t){t=t??this.element;for(const[s,n]of Object.entries(e))t.setAttribute(s,n)}addTextContent(e,t){t=t??this.element,t.textContent=e}}const te="_button_m7qff_1",ee="_actionButton_m7qff_11",se="_iconButton_m7qff_25",ne="_settings_m7qff_34",it={button:te,actionButton:ee,iconButton:se,settings:ne};class Mt extends N{constructor(e){super(),e&&this.addListener(e)}disabledElement(e){this.element.disabled=e}addListener(e){this.element.addEventListener("click",e)}createView(){return this.createDOMElement({tagName:"button",classList:[it.button]})}}const I={HOME:"Back to the start page",START:"Start",ADD_OPTION:"Add Option",CLEAR_LIST:"Clear List",PASTE_LIST:"Paste List",SAVE_LIST:"Save List to file",LOAD_LIST:"Load List from file",DELETE:"Delete",CONFIRM:"Confirm",CANCEL:"Cancel",CLOSE:"Close",BACK:"Back"},Tt={VOLUME:"Volume",ID:"ID",THEME:"Change theme"},O={NAMESPACE_SVG:"http://www.w3.org/2000/svg",NAMESPACE_XLINK:"http://www.w3.org/1999/xlink",QUALIFIED_NAME:"xlink:href"},f="./sprite.svg#",E={SOUND:{ON:f+"sound-on",OFF:f+"sound-off"},THEME:{ON:f+"theme-light",OFF:f+"theme-dark"},ALARM:f+"alarm",DELETE:f+"delete",SAVE:f+"save",LOAD:f+"load",BACK:f+"back",PASTE:f+"paste",CLEAR:f+"clear",PLAY:f+"play",ADD:f+"add"},ie={ariaLabel:"aria-label"},oe={BUTTON:"button"};class z extends Mt{constructor(t,s){super(s);o(this,"useSVGIcon");o(this,"svfElement");this.element.title=t.title,this.appendSVGIcon(t)}addClassSVG(t){var s;(s=this.svfElement)==null||s.classList.add(t)}appendSVGIcon(t){const{path:s,title:n}=t;if(s){const i=this.createSVGIcon({path:s,classList:[it.iconButton],attributes:{title:n,[ie.ariaLabel]:n}});this.appendElement(i)}}createSVGIcon({path:t,classList:s,attributes:n}){const i=document.createElementNS(O.NAMESPACE_SVG,"svg");s&&this.addClassList(s,i),this.addAttributes({...n,role:"img"},i);const c=document.createElementNS(O.NAMESPACE_SVG,"use");return c.setAttributeNS(O.NAMESPACE_XLINK,O.QUALIFIED_NAME,t),this.useSVGIcon=c,i.append(c),this.svfElement=i,i}}class xt extends z{constructor(e){super(e),this.addClassList([it.settings])}togglePath(e){var s;const t=e?this.pathOff:this.pathOn;(s=this.useSVGIcon)==null||s.setAttributeNS(O.NAMESPACE_XLINK,O.QUALIFIED_NAME,t)}addToggleListener(e){this.addListener(()=>{e.toggle()})}}class re extends xt{constructor(){const t=E.SOUND.ON,s=Tt.VOLUME;super({path:t,title:s});o(this,"pathOn");o(this,"pathOff",E.SOUND.OFF);o(this,"title");this.title=s,this.pathOn=t}}class Pt{constructor(e){this.button=e,this.button=e}}const ae="Decision Making Tool",ce="radomskaia--decision-making-tool--",ot=.5,h=0,S=1,g=2,Y="",Lt=0,le=-1,he=-1,ue=1,j={line:`
`,comma:",",dash:"-",hash:"#"},de={TYPE:"application/json",EXTENSION:".json",NAME:"option-list.json"},m={HOME:"/",DECISION_PICKER:"/decision-picker",NOT_FOUND:"404"},d={NOT_EVENT:"No event provided",ID_NOT_FOUND:"Can't update input value. Didn't find ID in the List",INVALID_FILE:"Invalid file",INVALID_LIST:"Invalid option list",CONTEXT_NOT_FOUND:"Failed to get context",ROUTE_NOT_FOUND:"Route not found",NOT_INITIALIZED:"Class is not initialized",PLAYBACK:"Can't play audio ",PAGE_NOT_FOUND:"Sorry, page not found",INIT_WHEEL_TEXT:"Please, press the button to start the wheel",VALIDATION:`Please add at least 2 valid options.

An option is considered valid if its title is not empty and its weight is greater than 0`},pe=300,Q=class Q{constructor(){o(this,"prefix");this.prefix=ce}static getInstance(){return Q.instance}save(e,t){const s=this.prefix+e;globalThis.localStorage.setItem(s,JSON.stringify(t))}load(e,t){const s=this.prefix+e,n=globalThis.localStorage.getItem(s);if(!n)return null;try{const i=JSON.parse(n);return t(i)?i:null}catch{return null}}};o(Q,"instance",new Q);let R=Q;var pt=(r=>(r.Title="title",r.Weight="weight",r))(pt||{}),v=(r=>(r.optionListValue="optionListValue",r.soundSettings="soundSettings",r))(v||{}),b=(r=>(r.strike="strike",r.end="end",r))(b||{});const ge=2,gt=j.hash,Ee={ID:"id",TITLE:"title",WEIGHT:"weight"},me={LAST_ID:"lastId",LIST:"list"},p=class p{constructor(e=Ee,t=me,s=gt){this.itemKeys=e,this.listKeys=t,this.idPrefix=s}static getInstance(){return p.instance||(p.instance=new p),p.instance}static isBoolean(e){return typeof e=="boolean"}static isPositiveNumber(e){return p.isNumber(e)&&e>=h}static isValidWeight(e){const t=typeof e=="string"?Number(e):e;return!Number.isNaN(t)&&this.isPositiveNumber(t)}static isValidOption(e){return e.title.trim().length>h&&Number(e.weight)>h}static hasMinimumOptions(e){return e.length>=ge}static isOptionsCountValid(e){const t=e.list.filter(s=>p.isValidOption(s));return p.hasMinimumOptions(t)}static isObject(e){return typeof e=="object"&&e!==null}static isString(e){return typeof e=="string"}static isNumber(e){return typeof e=="number"}static isEmptyOrStringifiedNumber(e){return e=e===Y?e:Number(e),!(p.isNumber(e)&&Number.isNaN(e))}isOptionListValue(e){if(!(this.isList(e)&&p.isPositiveNumber(e.lastId)&&Array.isArray(e.list)))return!1;for(const t of e.list)if(!this.isOptionItemValue(t,e.lastId))return!1;return!0}isList(e){return p.isObject(e)?this.listKeys.LAST_ID in e&&this.listKeys.LIST in e:!1}isOption(e){return p.isObject(e)?this.itemKeys.ID in e&&this.itemKeys.TITLE in e&&this.itemKeys.WEIGHT in e:!1}isOptionId(e,t){if(!p.isString(e)||e.slice(Lt,this.idPrefix.length)!==gt)return!1;let s=Number(e.slice(this.idPrefix.length));return!(Number.isNaN(s)||s<h||s>t)}isOptionItemValue(e,t){return this.isOption(e)&&this.isOptionId(e.id,t)&&p.isEmptyOrStringifiedNumber(e.weight)&&p.isString(e.title)}};o(p,"instance");let T=p;const fe=.7,wt=""+new URL("flint-strike-CTtTXcws.mp3",import.meta.url).href,Ie=""+new URL("end-sound-BuX6zaOv.mp3",import.meta.url).href,P=class P extends Pt{constructor(t){super(t);o(this,"isOff",!1);o(this,"audioElements",{[b.strike]:new Audio(wt),[b.end]:new Audio(Ie)});this.init(),this.audioElements[b.end].volume=fe,window.addEventListener("beforeunload",()=>{R.getInstance().save(v.soundSettings,this.isOff)})}static getInstance(t){if(!P.instance){if(!t)throw new Error(d.NOT_INITIALIZED);P.instance=new P(t)}return P.instance}updateSettings(){for(const t of Object.values(this.audioElements))t.muted=this.isOff;this.button.togglePath(this.isOff)}onEnded(t,s){this.audioElements[t].addEventListener("ended",s,{once:!0})}playAudio(t){if(!this.isOff){if(t===b.strike){new Audio(wt).play().catch(n=>console.error(d.PLAYBACK+t,n));return}this.audioElements[t].play().catch(s=>console.error(d.PLAYBACK+t,s))}}stopAudio(t){this.isOff||this.audioElements[t].currentTime===h||(this.audioElements[t].pause(),this.audioElements[t].currentTime=h)}getButton(){return this.button}toggle(){this.isOff=!this.isOff,this.updateSettings()}init(){const t=R.getInstance().load(v.soundSettings,T.isBoolean);t!==null&&(this.isOff=t,this.updateSettings());for(const s of Object.values(this.audioElements))s.load()}};o(P,"instance");let Z=P;class Te extends xt{constructor(){const t=E.THEME.ON,s=Tt.THEME;super({path:t,title:s});o(this,"pathOn");o(this,"pathOff",E.THEME.OFF);o(this,"title");this.title=s,this.pathOn=t}}const Et=25;let C=window.innerWidth<528?window.innerWidth-Et:512;const lt=C/g,ht=1e3,Le=100,X={RGB_MAX:255,OPACITY:.8,TYPE:"rgb"},q={DURATION:5,TURNS_COUNT:5},l={CENTER:{X:lt,Y:lt+Et/g},RADIUS:{BIG:lt-Et,SMALL:20},INITIAL_DEGREE:-90,HALF_DEGREE:180,START_ANGLE:0,FULL_RADIAN:Math.PI*g},L={OFFSET:.55,FONT:{SIZE:"16px",FAMILY:"inter"},ALIGN:"center",BASELINE:"middle",MAX_WIDTH:l.RADIUS.BIG/2,MIN_ANGLE:.18,ELLIPSIS:"..."},A={ANGLE:{MIN:20,MAX:60},Y:{TOP:50,BOTTOM:10,MIDDLE:20},WIDTH:35};function Ae(r,e){const t=(r+e)/g,s=l.RADIUS.BIG*L.OFFSET,n=l.CENTER.X+Math.cos(t)*s,i=l.CENTER.Y+Math.sin(t)*s,c=t+Math.PI/ot;return{textX:n,textY:i,textAngle:c}}function Ne(r,e){return l.FULL_RADIAN/r*e}function ut(r){return r*(Math.PI/l.HALF_DEGREE)}function Oe(r){return Math.floor((Math.random()*X.RGB_MAX+r)/g)}function Se(r){const e=r*g;return e>X.RGB_MAX?(e-X.RGB_MAX)/g:(e+X.RGB_MAX)/g}function we(r){const e=[],t=X.TYPE;for(let s=h;s<t.length;s++)e.push(Oe(r));return e}function Ct(r){return`rgb(${r.join(j.comma)},${X.OPACITY})`}function Ce(r){let e=h;for(const t of r){const s=Number(t.weight);e+=s}return e}function _e(r){return r<ot?g*r*r:S-Math.pow(-2*r+g,g)/g}function De(r,e){return S-r/e}function be(r,e=pe){let t;return function(){clearTimeout(t),t=setTimeout(()=>r(),e)}}function Re(){return document.body.scrollHeight-window.innerHeight>=window.scrollY}function dt(r){return(r+l.FULL_RADIAN)%l.FULL_RADIAN}class Me extends N{constructor(t=window.devicePixelRatio){super(t);o(this,"context");o(this,"drawSectors",(t,s,n)=>{this.context.clearRect(h,h,C,C);for(const i of t){let{startAngle:c,angle:u,color:x,title:G,isTitle:Vt}=i;if(n){const{offset:at,updateSector:ct}=n;i.startAngle+=at,i.startAngle>l.FULL_RADIAN&&(i.startAngle-=l.FULL_RADIAN),ct(c,u,G,x)}const Ot=c+u;if(this.drawSector(c,Ot,x,s.stroke),Vt){const{textX:at,textY:ct,textAngle:Ut}=Ae(c,Ot);this.drawText(this.truncateText(G),at,ct,Ut,s)}}this.drawCircle(s.stroke,l.RADIUS.SMALL+S),this.drawCircle(s.stroke,l.RADIUS.BIG),this.drawCursor(s,n==null?void 0:n.angle)});o(this,"drawSector",(t,s,n,i)=>{const{context:c}=this;c.beginPath(),c.moveTo(l.CENTER.X,l.CENTER.Y),c.arc(l.CENTER.X,l.CENTER.Y,l.RADIUS.BIG,t,s),c.closePath(),c.fillStyle=n,c.strokeStyle=i,c.fill(),c.stroke()});o(this,"drawText",(t,s,n,i,c)=>{const{context:u}=this;u.save(),u.translate(s,n),u.rotate(i),u.font=`${L.FONT.SIZE} ${L.FONT.FAMILY}`,u.textAlign=L.ALIGN,u.textBaseline=L.BASELINE,u.fillStyle=c.stroke,u.strokeStyle=c.cursor,u.strokeText(t,h,h),u.fillText(t,h,h),u.restore()});this.context=this.getContext(),this.context.scale(t,t),this.drawClip()}getContext(){const t=this.element.getContext("2d");if(!t)throw new Error(d.CONTEXT_NOT_FOUND);return t}drawCursor(t,s){const{context:n}=this;n.save(),s&&this.rotateCursor(s),n.beginPath(),n.moveTo(l.CENTER.X,A.Y.TOP),n.lineTo(l.CENTER.X-A.WIDTH/g,A.Y.BOTTOM),n.lineTo(l.CENTER.X,A.Y.MIDDLE),n.lineTo(l.CENTER.X+A.WIDTH/g,A.Y.BOTTOM),n.closePath(),n.fillStyle=t.cursor,n.strokeStyle=t.stroke,n.fill(),n.stroke(),n.restore()}createView(t){const s=C*t,n=this.createDOMElement({tagName:"canvas",attributes:{width:s.toString(),height:s.toString()}});return s>C&&(n.style.width=C.toString()+"px"),n}drawCircle(t,s){const{context:n}=this;n.lineWidth++,n.beginPath(),n.arc(l.CENTER.X,l.CENTER.Y,s,l.START_ANGLE,l.FULL_RADIAN,!0),n.closePath(),n.strokeStyle=t,s===l.RADIUS.SMALL+S&&(n.fillStyle=t,n.fill()),n.stroke(),n.lineWidth--}drawClip(){const{context:t}=this;t.beginPath(),t.rect(h,h,C,C),t.arc(l.CENTER.X,l.CENTER.Y,l.RADIUS.SMALL,l.START_ANGLE,l.FULL_RADIAN,!0),t.clip()}rotateCursor(t){const{context:s}=this;s.translate(l.CENTER.X,A.Y.MIDDLE),s.rotate(t),s.translate(-l.CENTER.X,-20)}truncateText(t){const{context:s}=this;let n=s.measureText(t).width;if(!(n>L.MAX_WIDTH))return t;let i=t,c=i+L.ELLIPSIS;for(;n>L.MAX_WIDTH;)i=i.slice(Lt,he),c=i+L.ELLIPSIS,n=s.measureText(c).width;return i+=L.ELLIPSIS,i}}const xe=15,Pe=80,At={TITLE:"Title",WEIGHT:"Weight",INSTRUCTION:`
Paste a list of new options in a CSV-like format:

title,weight(number)              -> | title                           |weight|
title,1                           -> | title                           | 1 |
title with whitespace,2           -> | title with whitespace           | 2 |
title , with , commas,3           -> | title , with , commas           | 3 |
title with &quot;quotes&quot;,4   -> | title with &quot;quotes&quot;   | 4 |
`},rt={TEXT:"text",NUMBER:"number",FILE:"file"},Bt="duration",Be="any",B=class B{constructor(){o(this,"validator");o(this,"separator");o(this,"config");this.validator=T.getInstance(),this.separator=j,this.config=de}static getInstance(){return B.instance||(B.instance=new B),B.instance}loadJSON(e){const t=document.createElement("input");t.type=rt.FILE,t.accept=this.config.EXTENSION,t.addEventListener("change",()=>{const s=t.files;if(!s)throw new Error(d.INVALID_FILE);s[Lt].text().then(n=>{const i=JSON.parse(n);if(!this.validator.isOptionListValue(i))throw new Error(d.INVALID_LIST);e.setList(i)})}),t.click()}saveJSON(e){let t=new Blob([JSON.stringify(e.getList())],{type:this.config.TYPE}),s=URL.createObjectURL(t);const n=document.createElement("a");n.href=s,n.download=this.config.NAME,n.click(),URL.revokeObjectURL(s)}parseCSV(e){var n;const t=e.split(this.separator.line),s={list:[]};for(const i of t){const c=i.split(this.separator.comma),u=(n=c.pop())==null?void 0:n.trim();if(!u||!T.isValidWeight(u))continue;const x=c.join(this.separator.comma).trim();if(!x)continue;const G={title:x,weight:u};s.list.push(G)}return T.isPositiveNumber(s.list.length)?s:null}loadLSData(){const e=R.getInstance().load(v.optionListValue,this.validator.isOptionListValue.bind(T.getInstance()));if(!e)return null;const t=e.list.filter(s=>T.isValidOption(s));return T.hasMinimumOptions(t)?[...t].sort(()=>Math.random()-ot):null}};o(B,"instance");let K=B;class ye{constructor(e,t,s){o(this,"sectorData",[]);o(this,"duration",q.DURATION*ht);o(this,"startAngle",ut(l.INITIAL_DEGREE));o(this,"currentTitle",null);o(this,"currentTitleColor",Y);o(this,"startAnimation",null);o(this,"turnsCount",q.TURNS_COUNT);o(this,"audio",Z.getInstance());o(this,"cursorAnimationDuration",ht);o(this,"cursorAnimationStartTimestamp",h);o(this,"cursorBounceAngle",ut(A.ANGLE.MIN));o(this,"isRotate",!1);o(this,"cursorAngle",h);o(this,"colors");o(this,"updateCurrentSector",(e,t,s,n)=>{this.isAngleInCursorRange(e,t)&&(s!==this.currentTitle||n!==this.currentTitleColor)&&(this.isRotate&&(this.cursorAngle-=Math.floor(this.cursorAngle/l.FULL_RADIAN)*l.FULL_RADIAN),this.isRotate=!0,this.cursorAnimationStartTimestamp=Date.now(),this.audio.stopAudio(b.strike),this.audio.playAudio(b.strike),this.currentTitle=s,this.currentTitleColor=n,this.titleSection.textContent=s)});this.drawSectors=e,this.titleSection=t,this.toggleViewState=s;const n=nt.getInstance();n.addListener(this.changeWheelColors.bind(this)),this.colors=n.getColors(),this.drawSectors=e,this.titleSection=t,this.init(),this.drawSectors(this.sectorData,{cursor:this.colors.cursor,stroke:this.colors.stroke}),this.toggleViewState=s}setDuration(e){this.duration=e*ht}isSectorData(){return this.sectorData.length>h}animateWheel(){if(M.getInstance().getCurrentRoute()!==m.DECISION_PICKER){this.toggleViewState(!0,this.currentTitleColor);return}const e=Date.now();this.startAnimation||(this.startAnimation=e);const t=e-this.startAnimation;if(t>this.duration&&!this.isRotate){this.endWheelAnimation();return}const s=this.getOffsetAngle(t);let n=this.cursorAngle;this.isRotate&&(n=this.animateCursor()),this.drawSectors(this.sectorData,{cursor:this.colors.cursor,stroke:this.colors.stroke},{offset:s,updateSector:this.updateCurrentSector.bind(this),angle:n}),requestAnimationFrame(()=>this.animateWheel())}changeWheelColors(e){this.colors=e;for(const t of this.sectorData){const s=[];for(const i of t.rgbArray)s.push(Se(i));t.rgbArray=s;const n=Ct(s);!this.startAnimation&&this.currentTitleColor===t.color&&(this.currentTitleColor=n,this.toggleViewState(!0,n)),t.color=n}this.drawSectors(this.sectorData,{cursor:this.colors.cursor,stroke:this.colors.stroke})}animateCursor(){const e=Date.now(),t=this.cursorAngle;let n=(e-this.cursorAnimationStartTimestamp)/this.cursorAnimationDuration,i;return this.cursorBounceAngle=this.calculateCursorAngle(e),n<=ot?(n*=g,i=Math.sin(n*Math.PI)*-this.cursorBounceAngle):(n*=g,i=S-Math.sin(n*Math.PI)*this.cursorBounceAngle),this.cursorAngle=t-i,n>=S?(this.isRotate=!1,this.cursorAngle=h,h):i}calculateCursorAngle(e){const t=e-this.cursorAnimationStartTimestamp,s=this.cursorAnimationDuration/g,n=Math.max(h,(s-t)/s);return ut(A.ANGLE.MIN+n*(A.ANGLE.MAX-A.ANGLE.MIN))}isAngleInCursorRange(e,t){const s=dt(this.startAngle),n=dt(e+t);return e=dt(e),e<n?s>=e&&s<=n:s>=e||s<=n}getOffsetAngle(e){const t=De(e,this.duration);return(this.turnsCount*l.FULL_RADIAN+Math.floor(Math.random()*l.FULL_RADIAN))/Le*_e(t)}endWheelAnimation(){this.audio.playAudio(b.end),this.startAnimation=null,this.turnsCount=q.TURNS_COUNT,this.toggleViewState(!0,this.currentTitleColor),this.audio.getButton().disabledElement(!1)}init(){const e=K.getInstance().loadLSData();if(!e)return;const t=Ce(e);let s=this.startAngle;for(const{weight:n,title:i}of e){const c=Ne(t,Number(n)),u=we(this.colors.thinner),x=Ct(u),G={startAngle:s,angle:c,color:x,rgbArray:u,title:i,isTitle:c>L.MIN_ANGLE};s+=c,this.sectorData.push(G)}}}class Nt extends N{constructor(e){super(),e&&(this.element.value=e)}get value(){return this.element.value}addListener(e){this.element.addEventListener("change",e)}createView(){return this.createDOMElement({tagName:"input"})}}const Ve="_label_rg8tz_15",Ue="_icon_rg8tz_21",We="_input_rg8tz_32",Fe="_form_rg8tz_49",ve="_highlight_rg8tz_59",$={label:Ve,icon:Ue,input:We,form:Fe,highlight:ve};class Ge extends Nt{constructor(t){super(t);o(this,"duration",q.DURATION);o(this,"id",Bt);this.element.type=rt.NUMBER,this.element.min=this.duration.toString(),this.element.autofocus=!0,this.element.addEventListener("beforeinput",s=>{s.data===j.dash&&s.preventDefault()}),this.element.id=this.id}disabledElement(t){this.element.disabled=t}addLabel(t,s){const n=this.createDOMElement({tagName:"label",classList:s,attributes:{for:this.id,title:t}});return n.append(this.createSVGIcon(E.ALARM)),n}createSVGIcon(t){const s=document.createElementNS(O.NAMESPACE_SVG,"svg");this.addAttributes({role:"img"},s),s.classList.add($.icon);const n=document.createElementNS(O.NAMESPACE_SVG,"use");return n.setAttributeNS(O.NAMESPACE_XLINK,O.QUALIFIED_NAME,t),s.append(n),s}}const y=class y extends N{constructor(){super();o(this,"canvas");o(this,"wheel");o(this,"text");o(this,"controllerElements",[]);o(this,"form",null);o(this,"controlsWrapper");o(this,"input",null);o(this,"toggleViewState",(t,s)=>{for(const n of this.controllerElements)n.disabledElement(!t);this.text.classList.toggle($.highlight,t),this.text.style.backgroundColor=s});this.canvas=new Me,this.text=this.createDOMElement({tagName:"p",textContent:d.INIT_WHEEL_TEXT}),this.controlsWrapper=this.createControlsWrapper(),this.appendElement(this.controlsWrapper,this.text,this.canvas.getElement())}static getInstance(){return y.instance||(y.instance=new y),y.instance}isRenderWheel(){this.wheel=new ye(this.canvas.drawSectors,this.text,this.toggleViewState);const t=this.wheel.isSectorData();return t&&(this.text.textContent=d.INIT_WHEEL_TEXT,this.text.style.backgroundColor=Y),t}focusInput(){var t;(t=this.input)==null||t.focus()}createView(){return this.createDOMElement({tagName:"main",classList:[a.container,a.flex,a.gap30,a.flexColumn,a.alignCenter]})}addButtons(){const t=new z({title:I.BACK,path:E.BACK},()=>M.getInstance().navigateTo(m.HOME)),s=new z({title:I.START,path:E.PLAY},()=>{var n;this.wheel&&((n=this.form)!=null&&n.reportValidity())&&(Z.getInstance().getButton().disabledElement(!0),this.toggleViewState(!1,Y),this.wheel.animateWheel())});this.controllerElements.push(t,s),this.controlsWrapper.append(t.getElement(),s.getElement())}createControlsWrapper(){return this.controlsWrapper=this.createDOMElement({tagName:"div",classList:[a.flex,a.center,a.gap30]}),this.addButtons(),this.form=this.addInputForm(),this.controlsWrapper}addInputForm(){const t=this.createDOMElement({tagName:"form",classList:[a.positionRelative,$.form]}),s=new Ge(q.DURATION.toString());this.controllerElements.push(s),s.addListener(()=>{var i;return(i=this.wheel)==null?void 0:i.setDuration(Number(s.value))});const n=s.getElement();return n.classList.add($.input),t.append(s.addLabel(Bt,[$.label]),n),this.controlsWrapper.append(t),this.input=n,t}};o(y,"instance");let J=y;const He="_optionsList_18708_1",Xe="_optionItem_18708_6",ke="_title_18708_11",Ye="_weight_18708_12",Ke="_icon_18708_36",H={optionsList:He,optionItem:Xe,title:ke,weight:Ye,icon:Ke},w=class w extends N{constructor(t){super();o(this,"_id");t||w.incrementId(),this._id=t||`${gt}${w.getId()}`,this.element.textContent=this._id}get id(){return this._id}static resetId(){w.id=h}static getId(){return w.id}static setId(t){w.id=t}static incrementId(){w.id++}createView(){return this.createDOMElement({tagName:"div",attributes:{title:Tt.ID}})}};o(w,"id",h);let k=w;class je extends Nt{constructor(e){super(e),this.element.placeholder=At.TITLE,this.element.type=rt.TEXT}}class $e extends Nt{constructor(e){super(e),this.element.placeholder=At.WEIGHT,this.element.type=rt.NUMBER,this.element.step=Be,this.element.min=h.toString(),this.element.addEventListener("beforeinput",t=>{t.data===j.dash&&t.preventDefault()})}}class qe extends N{constructor(t){super();o(this,"id");o(this,"title");o(this,"weight");o(this,"button");this.id=this.addID(t==null?void 0:t.id),this.title=this.addTitleInput(t==null?void 0:t.title),this.weight=this.addWeightInput(t==null?void 0:t.weight),this.button=this.addDeleteButton()}getValue(){return{id:this.id,title:this.title.value,weight:this.weight.value}}focusInput(){this.title.getElement().focus()}addListener(t,s){this[t].addListener(s)}createView(){return this.createDOMElement({tagName:"li",classList:[H.optionItem,a.flex,a.gap10,a.center,a.widthFull]})}addID(t){const s=new k(t);return this.appendElement(s.getElement()),s.id}addTitleInput(t){const s=new je(t),n=s.getElement();return n.classList.add(H.title,a.widthFull),this.appendElement(n),s}addWeightInput(t){const s=new $e(t),n=s.getElement();return n.classList.add(H.weight),this.appendElement(n),s}addDeleteButton(){const t=new z({title:I.DELETE,path:E.DELETE});return t.getElement().classList.add(H.button),t.addClassSVG(H.icon),this.appendElement(t.getElement()),t}}class Qe extends N{constructor(t){super();o(this,"optionListValue",{lastId:h,list:[]});o(this,"inputTypes",[pt.Title,pt.Weight]);t&&(this.optionListValue=t),window.addEventListener("beforeunload",()=>{document.activeElement instanceof HTMLInputElement&&document.activeElement.blur(),R.getInstance().save(v.optionListValue,this.optionListValue)})}init(){const t=R.getInstance().load(v.optionListValue,T.getInstance().isOptionListValue.bind(T.getInstance()));t===null?this.addOption():this.setList(t)}addOption(t){const s=new qe(t);this.appendElement(s.getElement()),s.focusInput();const n=s.getValue().id;if(!n)throw new Error(d.ID_NOT_FOUND);s.addListener("button",()=>{this.deleteOption(n,s)});for(const i of this.inputTypes)s.addListener(i,c=>{if(!c)throw new Error(d.NOT_EVENT);this.inputHandler(i,n,c)});t!=null&&t.id||this.updateList(s.getValue(),k.getId())}getList(){return structuredClone(this.optionListValue)}setList(t){t.lastId&&(this.reset(),this.optionListValue=t,k.setId(t.lastId));for(const s of t.list)this.addOption(s)}reset(){this.optionListValue.lastId=h,this.optionListValue.list=[],k.resetId(),this.clearElement()}createView(){return this.createDOMElement({tagName:"ul",classList:[H.optionsList,a.flex,a.gap10,a.flexColumn,a.widthFull]})}updateList(t,s){this.optionListValue.list.push(t),this.optionListValue.lastId=s}deleteOption(t,s){const n=this.getOptionIndex(t);this.optionListValue.list.splice(n,ue),s.getElement().remove(),this.optionListValue.list.length===h&&this.reset()}getOptionIndex(t){const s=this.optionListValue.list.findIndex(n=>n.id===t);if(s===le)throw new Error(d.ID_NOT_FOUND);return s}inputHandler(t,s,n){const i=this.optionListValue.list,c=this.getOptionIndex(s);n.target instanceof HTMLInputElement&&(i[c][t]=n.target.value)}}const ze="_modal_4dba0_1",Ze="_wrapper_4dba0_17",Je="_validText_4dba0_30",ts="_form_4dba0_34",es="_input_4dba0_39",tt={modal:ze,wrapper:Ze,validText:Je,form:ts,input:es};class yt extends N{constructor(){super();o(this,"modalWrapper");this.modalWrapper=this.addWrapper(),this.modalWrapper.append(this.addContent()),this.element.addEventListener("close",()=>{this.element.remove()})}showModal(){document.body.append(this.element),this.element.showModal()}createView(){const t=this.createDOMElement({tagName:"dialog",classList:[tt.modal]});return t.addEventListener("click",s=>{s.target===s.currentTarget&&this.element.close()}),t}addWrapper(){const t=this.createDOMElement({tagName:"div",classList:[tt.wrapper,a.flex,a.flexColumn,a.alignCenter,a.gap20]});return this.element.append(t),t}}class st extends Mt{constructor(e,t){super(t),this.element.textContent=e,this.addClassList([it.actionButton])}}const _=class _ extends yt{constructor(e){super(),this.optionList=e,this.optionList=e}static getInstance(e){if(!_.instance&&e&&(_.instance=new _(e)),!_.instance)throw new Error(d.NOT_INITIALIZED);return _.instance}addContent(){const e=this.createDOMElement({tagName:"form",classList:[tt.form,a.gap20]}),t=this.createTextareaElement(),s=this.createCancelButton();this.addCloseListener(()=>{t.value=Y});const n=new st(I.CONFIRM).getElement();return e.addEventListener("submit",i=>{this.submitHandler(i,t)}),e.append(t,s,n),e}createTextareaElement(){const e=this.createDOMElement({tagName:"textarea",classList:[tt.input]});return e.placeholder=At.INSTRUCTION,e.rows=xe,e.cols=Pe,e}createCancelButton(){const e=new st(I.CANCEL);return e.getElement().type=oe.BUTTON,e.addListener(()=>{this.element.close()}),e.getElement()}addCloseListener(e){this.element.addEventListener("close",e)}submitHandler(e,t){e.preventDefault();const s=t.value.trim(),n=K.getInstance().parseCSV(s);n&&(this.element.close(),this.optionList.setList(n))}};o(_,"instance");let mt=_;const V=class V extends yt{constructor(){super(),this.addContent()}static getInstance(){return V.instance||(V.instance=new V),V.instance}addContent(){const e=this.createDOMElement({tagName:"div",classList:[a.flex,a.flexColumn,a.alignCenter,a.gap20]}),t=this.createDOMElement({tagName:"p",classList:[tt.validText],textContent:d.VALIDATION}),s=new st(I.CLOSE,()=>{this.element.close()}).getElement();return e.append(t,s),e}};o(V,"instance");let ft=V;const ss="_buttonWrapper_gr9ed_1",ns="_highlight_gr9ed_14",_t={buttonWrapper:ss,highlight:ns},U=class U extends N{constructor(){super();o(this,"buttonsConfig",[{title:I.ADD_OPTION,path:E.ADD,callback:()=>{this.optionList.addOption(),window.scrollTo(h,document.body.scrollHeight)}},{title:I.CLEAR_LIST,path:E.CLEAR,callback:()=>this.optionList.reset()},{title:I.PASTE_LIST,path:E.PASTE,callback:()=>mt.getInstance(this.optionList).showModal()},{title:I.SAVE_LIST,path:E.SAVE,callback:()=>K.getInstance().saveJSON(this.optionList)},{title:I.LOAD_LIST,path:E.LOAD,callback:()=>K.getInstance().loadJSON(this.optionList)},{title:I.START,path:E.PLAY,callback:()=>{const t=this.optionList.getList();T.isOptionsCountValid(t)?M.getInstance().navigateTo(m.DECISION_PICKER):ft.getInstance().showModal()}}]);o(this,"optionList");o(this,"buttonWrapper");this.optionList=new Qe,this.optionList.init(),this.appendElement(this.optionList.getElement()),this.buttonWrapper=this.createButtonWrapper(),this.addScrollListener()}static getInstance(){return U.instance||(U.instance=new U),U.instance}saveToLocalStorage(){R.getInstance().save(v.optionListValue,this.optionList.getList())}createView(){return this.createDOMElement({tagName:"main",classList:[a.container,a.flex,a.gap30,a.flexColumn,a.alignCenter]})}addButtons(t){for(const{title:s,path:n,callback:i}of this.buttonsConfig){const c=new z({title:s,path:`${n}`},i);t.append(c.getElement())}}createButtonWrapper(){const t=this.createDOMElement({tagName:"div",classList:[_t.buttonWrapper,a.flex,a.alignCenter,a.justifyBetween,a.flexWrap]});return this.addButtons(t),this.appendElement(t),t}addScrollListener(){window.addEventListener("scroll",be(()=>{this.buttonWrapper.classList.toggle(_t.highlight,Re())}))}};o(U,"instance");let et=U;const D=class D{constructor(){o(this,"routes",[]);o(this,"currentPath",Y);globalThis.addEventListener("hashchange",()=>{this.routerChange()})}static getInstance(){return D.instance||(D.instance=new D),D.instance}static canNavigateToDecision(e){if(e.path!==m.DECISION_PICKER)return!0;const t=e.component.getInstance();return t instanceof J&&t.isRenderWheel()}addRoutes(e){this.routes=e,this.routerChange()}navigateTo(e){this.currentPath=e,this.clearPage();let t=this.findValidRoute(e);if(!t)throw new Error(d.ROUTE_NOT_FOUND);globalThis.location.hash=t.path,document.body.append(t.component.getInstance().getElement());const s=t.component.getInstance();s instanceof J?s.focusInput():s instanceof et&&window.scrollTo(S,S)}getCurrentRoute(){return this.currentPath}findValidRoute(e){var s,n;let t=this.routes.find(i=>i.path===e)||this.routes.find(i=>i.path===m.NOT_FOUND);if(e===m.DECISION_PICKER){const i=(s=this.routes.find(c=>c.path===m.HOME))==null?void 0:s.component.getInstance();i instanceof et&&i.saveToLocalStorage()}return t&&!D.canNavigateToDecision(t)&&(t=(n=this.routes)==null?void 0:n.find(i=>i.path===m.HOME)),t}clearPage(){if(!this.routes)throw new Error(d.ROUTE_NOT_FOUND);for(const e of this.routes){const t=e.component.getInstance().getElement();t.parentNode&&t.remove()}}routerChange(){const e=globalThis.location.hash.slice(j.hash.length)||m.HOME;e!==this.currentPath&&this.navigateTo(e)}};o(D,"instance");let M=D;const is=0,os=255,Dt="#ccc19f",bt="#1c274d",rs="(prefers-color-scheme: dark)",as="data-theme",Rt={DARK_THEME:{thinner:is,cursor:bt,stroke:Dt},LIGHT_THEME:{thinner:os,cursor:Dt,stroke:bt}},W=class W extends Pt{constructor(t){super(t);o(this,"isOff");o(this,"colors",null);o(this,"mediaQueryList");o(this,"toggleListener",null);this.mediaQueryList=globalThis.matchMedia(rs),this.isOff=this.mediaQueryList.matches,this.setColors(this.isOff),this.changeTheme(this.isOff),this.mediaQueryList.addEventListener("change",s=>{this.changeTheme(s.matches)})}static getInstance(t){if(!W.instance){if(!t)throw new Error(d.NOT_INITIALIZED);W.instance=new W(t)}return W.instance}getColors(){if(this.colors)return this.colors;throw new Error(d.NOT_INITIALIZED)}toggle(){this.isOff=!this.isOff,this.changeTheme(this.isOff)}addListener(t){this.toggleListener=t}setColors(t){this.colors=t?Rt.DARK_THEME:Rt.LIGHT_THEME}changeTheme(t){this.button.togglePath(t),this.setColors(t),document.body.toggleAttribute(as,t),M.getInstance().getCurrentRoute()===m.DECISION_PICKER&&this.toggleListener&&this.colors&&this.toggleListener(this.colors)}};o(W,"instance");let nt=W;class cs extends N{constructor(){super();o(this,"settingsButton",{sound:{button:re,action:Z},theme:{button:Te,action:nt}});o(this,"buttonWrapper");this.buttonWrapper=this.createButtonWrapper(),this.appendElement(this.buttonWrapper)}addSoundButton(t){const s=new this.settingsButton[t].button,n=this.settingsButton[t].action.getInstance(s);return s.addToggleListener(n),this.buttonWrapper.append(s.getElement()),this}createView(){const t=this.createDOMElement({tagName:"header",classList:[St.header,a.container,a.flex,a.alignCenter,a.justifyBetween,a.widthFull]}),s=this.createDOMElement({tagName:"h1",textContent:ae,classList:[St.headerPrimary]});return t.append(s),t}createButtonWrapper(){return this.createDOMElement({tagName:"div",classList:[a.flex,a.center,a.gap30]})}}const F=class F extends N{constructor(){super();o(this,"homeButton");this.homeButton=new st(I.HOME,()=>M.getInstance().navigateTo(m.HOME)),this.appendElement(this.homeButton.getElement())}static getInstance(){return F.instance||(F.instance=new F),F.instance}createView(){const t=this.createDOMElement({tagName:"main",classList:[a.flex,a.container,a.flexColumn,a.center,a.gap30]}),s=this.createDOMElement({tagName:"p",textContent:d.PAGE_NOT_FOUND});return t.append(s),t}};o(F,"instance");let It=F;const ls=[{path:m.HOME,component:et},{path:m.DECISION_PICKER,component:J},{path:m.NOT_FOUND,component:It}],hs=document.body,us=new cs().addSoundButton("theme").addSoundButton("sound").getElement();hs.append(us);M.getInstance().addRoutes(ls);window.scrollTo(S,S);
//# sourceMappingURL=main-CrxbhHUk.js.map
